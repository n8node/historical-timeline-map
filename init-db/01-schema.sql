-- Historical Timeline Map — Database Initialization

CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- Users table (for admin panel)
CREATE TABLE IF NOT EXISTS users (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(50) DEFAULT 'admin',
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Persons table (historical figures)
CREATE TABLE IF NOT EXISTS persons (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    name VARCHAR(255) NOT NULL,
    name_original VARCHAR(255),

    birth_year INTEGER NOT NULL,
    death_year INTEGER NOT NULL,
    birth_year_approximate BOOLEAN DEFAULT FALSE,
    death_year_approximate BOOLEAN DEFAULT FALSE,

    birth_lat DOUBLE PRECISION,
    birth_lon DOUBLE PRECISION,
    death_lat DOUBLE PRECISION,
    death_lon DOUBLE PRECISION,
    birth_place_name VARCHAR(255),
    death_place_name VARCHAR(255),

    main_photo_url VARCHAR(500) NOT NULL,
    description TEXT NOT NULL,
    activity_description VARCHAR(500),
    short_bio TEXT,

    era VARCHAR(100),
    category VARCHAR(100),

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    is_published BOOLEAN DEFAULT TRUE
);

-- Photo gallery
CREATE TABLE IF NOT EXISTS photo_gallery (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    person_id UUID NOT NULL REFERENCES persons(id) ON DELETE CASCADE,
    photo_url VARCHAR(500) NOT NULL,
    caption VARCHAR(255),
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Events table (future expansion)
CREATE TABLE IF NOT EXISTS events (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    name VARCHAR(255) NOT NULL,
    event_year INTEGER NOT NULL,
    location_lat DOUBLE PRECISION,
    location_lon DOUBLE PRECISION,
    location_name VARCHAR(255),
    description TEXT,
    type VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Indexes
CREATE INDEX IF NOT EXISTS idx_persons_birth_year ON persons(birth_year);
CREATE INDEX IF NOT EXISTS idx_persons_death_year ON persons(death_year);
CREATE INDEX IF NOT EXISTS idx_persons_life_period ON persons(birth_year, death_year);
CREATE INDEX IF NOT EXISTS idx_persons_published ON persons(is_published);
CREATE INDEX IF NOT EXISTS idx_persons_era ON persons(era);
CREATE INDEX IF NOT EXISTS idx_photo_gallery_person ON photo_gallery(person_id);

-- Seed data: 15 historical figures
INSERT INTO persons (name, name_original, birth_year, death_year, birth_year_approximate, death_year_approximate, birth_lat, birth_lon, death_lat, death_lon, birth_place_name, death_place_name, main_photo_url, description, activity_description, short_bio, era, category) VALUES

-- Ancient Egypt
('Клеопатра VII', 'Κλεοπάτρα', -69, -30, FALSE, FALSE, 31.2001, 29.9187, 31.2001, 29.9187, 'Александрия, Египет', 'Александрия, Египет', '/uploads/seed/клеопатра_vii_2fb906.jpg', 'Последняя царица эллинистического Египта из македонской династии Птолемеев. Прославилась как одна из самых могущественных женщин древнего мира, искусный дипломат и полиглот.', 'Царица Египта', 'Клеопатра VII — последняя правительница Египта из династии Птолемеев, известная своим умом, красотой и политическими союзами с Юлием Цезарем и Марком Антонием.', 'Древний мир', 'ruler'),

('Тутанхамон', 'Twt-ꜥnḫ-Jmn', -1342, -1325, TRUE, TRUE, 25.7402, 32.6014, 25.7402, 32.6014, 'Ахетатон, Египет', 'Фивы, Египет', '/uploads/seed/тутанхамон_001eea.jpg', 'Фараон Древнего Египта из XVIII династии Нового царства. Его гробница, обнаруженная практически нетронутой в 1922 году, стала одной из самых значимых археологических находок XX века.', 'Фараон Египта', 'Тутанхамон — молодой фараон, правивший Египтом и ставший одним из самых известных фараонов благодаря своей почти нетронутой гробнице.', 'Древний мир', 'ruler'),

-- Antiquity
('Александр Македонский', 'Ἀλέξανδρος ὁ Μέγας', -356, -323, FALSE, FALSE, 40.5167, 22.4667, 32.6500, 44.4167, 'Пелла, Македония', 'Вавилон, Месопотамия', '/uploads/seed/александр_македонский_bc232d.jpg', 'Царь Македонии, создатель мировой державы, величайший полководец древности. За 13 лет завоевал огромную территорию от Греции до Индии, распространив эллинистическую культуру.', 'Царь Македонии, полководец', 'Александр Великий — один из величайших завоевателей в истории, создавший империю от Греции до Индии к 30 годам.', 'Древний мир', 'ruler'),

('Аристотель', 'Ἀριστοτέλης', -384, -322, FALSE, FALSE, 40.5197, 23.7297, 38.4461, 23.6039, 'Стагира, Македония', 'Халкида, Эвбея', '/uploads/seed/аристотель_27f82c.jpg', 'Древнегреческий философ и учёный, ученик Платона, воспитатель Александра Македонского. Основоположник формальной логики, создатель всеобъемлющей системы философии.', 'Философ, учёный', 'Аристотель — величайший мыслитель античности, чьи труды охватывали логику, физику, биологию, этику, политику и метафизику.', 'Древний мир', 'scientist'),

('Гай Юлий Цезарь', 'Gaius Iulius Caesar', -100, -44, FALSE, FALSE, 41.8919, 12.5113, 41.8919, 12.5113, 'Рим, Римская республика', 'Рим, Римская республика', '/uploads/seed/гай_юлий_цезарь_6ea0c2.jpg', 'Древнеримский государственный деятель, полководец, писатель. Покоритель Галлии, диктатор Римской республики. Его правление стало поворотным моментом в истории Рима.', 'Диктатор Рима, полководец', 'Юлий Цезарь — римский полководец и политик, чьё правление ознаменовало переход от республики к империи.', 'Древний мир', 'ruler'),

-- Middle Ages
('Чингисхан', 'Чингис хаан', 1162, 1227, TRUE, FALSE, 48.5000, 108.0000, 38.0000, 105.0000, 'Делюн-Болдок, Монголия', 'Западное Ся (Тангут)', '/uploads/seed/чингисхан_9bd4e6.jpg', 'Основатель и первый великий хан Монгольской империи — крупнейшего в истории государства по площади. Объединил монгольские племена и создал империю от Тихого океана до Восточной Европы.', 'Великий хан Монгольской империи', 'Чингисхан — основатель Монгольской империи, величайший завоеватель средневековья, создавший крупнейшее государство в истории.', 'Средневековье', 'ruler'),

('Леонардо да Винчи', 'Leonardo di ser Piero da Vinci', 1452, 1519, FALSE, FALSE, 43.7833, 10.9500, 47.4100, 0.9900, 'Винчи, Флорентийская республика', 'Амбуаз, Франция', '/uploads/seed/леонардо_да_винчи_ab427b.jpg', 'Итальянский художник, учёный, изобретатель, писатель, один из крупнейших представителей искусства Высокого Возрождения. Автор «Моны Лизы» и «Тайной вечери».', 'Художник, учёный, изобретатель', 'Леонардо да Винчи — универсальный гений Возрождения, художник, инженер и учёный, опередивший своё время на столетия.', 'Средневековье', 'artist'),

('Жанна д''Арк', 'Jeanne d''Arc', 1412, 1431, FALSE, FALSE, 48.4439, 5.6733, 49.4432, 1.0993, 'Домреми, Франция', 'Руан, Франция', '/uploads/seed/жанна_дарк_02aa82.jpg', 'Национальная героиня Франции, командовавшая французскими войсками в нескольких сражениях Столетней войны. Была схвачена, осуждена как еретик и сожжена на костре в 19 лет.', 'Военачальник, святая', 'Жанна д''Арк — крестьянская девушка, ставшая военным лидером Франции и канонизированная как святая.', 'Средневековье', 'military'),

-- Early Modern Period
('Наполеон Бонапарт', 'Napoléon Bonaparte', 1769, 1821, FALSE, FALSE, 41.9198, 8.7389, -15.9300, -5.7200, 'Аяччо, Корсика', 'Остров Святой Елены', '/uploads/seed/наполеон_бонапарт_47ccb6.jpg', 'Французский император, полководец и государственный деятель. Пришёл к власти в ходе Великой французской революции, провёл реформы, изменившие Европу, и вёл наполеоновские войны.', 'Император Франции, полководец', 'Наполеон Бонапарт — французский император, один из величайших полководцев в истории, перекроивший карту Европы.', 'Новое время', 'ruler'),

('Александр Сергеевич Пушкин', NULL, 1799, 1837, FALSE, FALSE, 55.7558, 37.6173, 59.9343, 30.3351, 'Москва, Российская империя', 'Санкт-Петербург, Российская империя', '/uploads/seed/александр_сергеевич_пушкин_e2345f.jpg', 'Великий русский поэт, драматург и прозаик, заложивший основы русского реалистического направления. Автор «Евгения Онегина», «Капитанской дочки» и множества стихотворений.', 'Поэт, писатель', 'Пушкин — основоположник современного русского литературного языка, величайший русский поэт, «солнце русской поэзии».', 'Новое время', 'artist'),

('Людвиг ван Бетховен', 'Ludwig van Beethoven', 1770, 1827, FALSE, FALSE, 50.7340, 7.0986, 48.2082, 16.3738, 'Бонн, Священная Римская империя', 'Вена, Австрийская империя', '/uploads/seed/людвиг_ван_бетховен_67b6f8.jpg', 'Немецкий композитор и пианист, ключевая фигура перехода от классицизма к романтизму в музыке. Продолжал сочинять шедевры даже после полной потери слуха.', 'Композитор, пианист', 'Бетховен — великий композитор, автор девяти симфоний и множества произведений, изменивших историю музыки.', 'Новое время', 'artist'),

-- Modern Era
('Альберт Эйнштейн', 'Albert Einstein', 1879, 1955, FALSE, FALSE, 48.3984, 9.9916, 40.3573, -74.6672, 'Ульм, Германская империя', 'Принстон, США', '/uploads/seed/альберт_эйнштейн_28356d.jpg', 'Физик-теоретик, один из основателей современной теоретической физики. Лауреат Нобелевской премии по физике 1921 года. Автор теории относительности, изменившей понимание пространства и времени.', 'Физик-теоретик', 'Эйнштейн — создатель теории относительности, нобелевский лауреат, изменивший понимание Вселенной.', 'Новейшее время', 'scientist'),

('Юрий Алексеевич Гагарин', NULL, 1934, 1968, FALSE, FALSE, 55.3667, 34.9833, 56.7000, 38.0167, 'Клушино, СССР', 'Новосёлово, СССР', '/uploads/seed/юрий_алексеевич_гагарин_b17f68.jpg', 'Советский лётчик-космонавт, первый человек в истории, совершивший полёт в космическое пространство 12 апреля 1961 года на корабле «Восток-1». Герой Советского Союза.', 'Космонавт, лётчик', 'Гагарин — первый человек в космосе, совершивший орбитальный полёт 12 апреля 1961 года.', 'Новейшее время', 'scientist'),

('Никола Тесла', 'Nikola Tesla', 1856, 1943, FALSE, FALSE, 44.5603, 15.3775, 40.7580, -73.9855, 'Смилян, Австрийская империя', 'Нью-Йорк, США', '/uploads/seed/никола_тесла_b0f6b4.jpg', 'Изобретатель в области электротехники и радиотехники сербского происхождения. Известен вкладом в создание устройств, работающих на переменном токе, многофазных систем и электродвигателя.', 'Изобретатель, инженер', 'Никола Тесла — гениальный изобретатель, пионер в области переменного тока и беспроводной передачи энергии.', 'Новейшее время', 'scientist'),

('Махатма Ганди', 'मोहनदास करमचंद गांधी', 1869, 1948, FALSE, FALSE, 21.1702, 72.8311, 28.6042, 77.2250, 'Порбандар, Британская Индия', 'Нью-Дели, Индия', '/uploads/seed/махатма_ганди_bade83.jpg', 'Индийский политический и общественный деятель, один из руководителей и идеологов движения за независимость Индии от Великобритании. Идеолог ненасильственного сопротивления.', 'Политический лидер, философ', 'Махатма Ганди — лидер борьбы за независимость Индии, идеолог ненасильственного сопротивления.', 'Новейшее время', 'ruler');
